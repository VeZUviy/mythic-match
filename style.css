/* --- –û–°–ù–û–í–ù–Ü –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø --- */
* {
    box-sizing: border-box;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
}

body {
    background-color: #2c3e50;
    color: white;
    font-family: 'Arial', sans-serif;
    margin: 0; padding: 0;
    height: 100vh; width: 100vw;
    overflow: hidden;
    display: flex; flex-direction: column; align-items: center;
    touch-action: none;
}

#bg-layer {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -5;
    background-position: center center; background-size: cover; background-repeat: no-repeat;
    transition: background-image 1s ease-in-out;
}
#bg-layer::after {
    content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.4); /* –¢—Ä–æ—Ö–∏ —Å–≤—ñ—Ç–ª—ñ—à–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è —Ñ–æ–Ω—É */
    z-index: -1;
}

/* --- –ï–ö–†–ê–ù–ò --- */
#start-screen {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(20, 20, 40, 0.98);
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    z-index: 100; text-align: center; transition: opacity 0.5s;
}
.title-block h1 { font-size: 8vmin; color: #f1c40f; margin-bottom: 2vh; text-shadow: 0 0 15px #e67e22; }
.title-block p { font-size: 4vmin; color: #ccc; margin-bottom: 5vh; }

button {
    background: linear-gradient(to bottom, #e74c3c, #c0392b);
    border: none; color: white; padding: 15px 40px; border-radius: 30px; 
    font-size: 5vmin; font-weight: bold; cursor: pointer; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.3); transition: transform 0.2s; margin-bottom: 2vh;
}
button:active { transform: scale(0.95); }
.secondary-btn {
    background: transparent; border: 1px solid #7f8c8d; color: #bdc3c7;
    padding: 10px 20px; font-size: 3.5vmin; box-shadow: none; margin-top: 2vh;
}
.hidden { display: none !important; }

#story-modal, #win-modal {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); display: flex; justify-content: center; align-items: center; z-index: 90; padding: 20px;
}
.modal-content {
    background: #fff; color: #333; padding: 25px; border-radius: 12px; text-align: center; 
    width: 90%; max-width: 400px; box-shadow: 0 0 30px rgba(255,255,255, 0.15); 
    border-top: 5px solid #f1c40f; display: flex; flex-direction: column;
}
.story-text-container {
    background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0;
    border-left: 3px solid #ccc; text-align: left; max-height: 40vh; overflow-y: auto;
}
#story-text { font-style: italic; font-size: 16px; line-height: 1.6; margin: 0; color: #555; }
.modal-footer { margin-top: 10px; padding-top: 15px; border-top: 1px solid #eee; }
.goal-box { font-size: 18px; font-weight: bold; color: #e67e22; margin-bottom: 15px; display: block; }

/* --- –Ü–ì–†–û–í–ò–ô –Ü–ù–¢–ï–†–§–ï–ô–° --- */
#game-ui { 
    width: 100%; height: 100%; 
    display: flex; flex-direction: column; 
    align-items: center; 
    z-index: 10;
}

.header {
    width: 100%; padding: 1vh 2vw; 
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(0,0,0,0.85); 
    font-size: 3.5vmin; font-weight: bold; 
    border-bottom: 1px solid rgba(255,255,255,0.2);
    /* –§—ñ–∫—Å–æ–≤–∞–Ω–∞ –≤–∏—Å–æ—Ç–∞, —â–æ–± –Ω–µ —Å—Ç—Ä–∏–±–∞–ª–æ */
    height: 7vh; min-height: 40px; 
    flex-shrink: 0;
}

#status-message {
    height: 3vh; color: #f1c40f; font-size: 3vmin; margin: 0;
    font-weight: bold; text-shadow: 1px 1px 2px black;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
}

.game-container { 
    flex-grow: 1; 
    width: 100%; 
    display: flex; 
    justify-content: center; 
    /* –ó–ú–Ü–ù–ê: –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –ø–æ –≤–µ—Ä—Ö—É, –∞ –Ω–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É, —â–æ–± –Ω–µ –≤–∏–ª–∞–∑–∏–ª–æ –∑–Ω–∏–∑—É */
    align-items: flex-start; 
    padding-top: 1vh; /* –ù–µ–≤–µ–ª–∏–∫–∏–π –≤—ñ–¥—Å—Ç—É–ø –∑–≤–µ—Ä—Ö—É */
    overflow: hidden;
}

/* --- –°–Ü–¢–ö–ê --- */
.grid {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    grid-template-rows: repeat(12, 1fr); 
    gap: 2px; /* –¢–æ–Ω—à–∏–π –∑–∞–∑–æ—Ä –¥–ª—è –∞–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—ñ */
    
    background-color: rgba(0, 0, 0, 0.6); /* –¢–µ–º–Ω—ñ—à–∏–π —Ñ–æ–Ω –ø—ñ–¥–∫–ª–∞–¥–∫–∏ */
    padding: 4px;
    border-radius: 8px;
    border: 2px solid rgba(255,255,255,0.1);

    /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å: 2/3 –ø—Ä–æ–ø–æ—Ä—Ü—ñ—è */
    aspect-ratio: 2 / 3;
    
    /* –ó–ú–Ü–ù–ê: –ó–º–µ–Ω—à–∏–≤ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –≤–∏—Å–æ—Ç–∏ –∑ 82vh –¥–æ 75vh –¥–ª—è –±–µ–∑–ø–µ–∫–∏ –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–∞—Ö */
    width: min(96vw, calc(75vh * (2 / 3)));
    height: auto;
}

.cell {
    width: 100%; height: 100%; 
    border-radius: 12%; 
    
    /* –Ü–ö–û–ù–ö–ê (–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è) */
    background-size: 85%; 
    background-repeat: no-repeat; 
    background-position: center;
    
    cursor: pointer;
    background-color: transparent; /* –§–æ–Ω –ø—Ä–æ–∑–æ—Ä–∏–π, –±–æ –∫–æ–ª—ñ—Ä –±—É–¥–µ –≤ ::before */
    border: 1px solid rgba(255, 255, 255, 0.2); 
    
    position: relative; /* –©–æ–± ::before –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–≤—Å—è –≤—ñ–¥–Ω–æ—Å–Ω–æ –∫–ª—ñ—Ç–∏–Ω–∫–∏ */
    z-index: 1; /* –Ü–∫–æ–Ω–∫–∞ –∑–≤–µ—Ä—Ö—É */
    transition: transform 0.1s;
}

/* --- –®–ê–† –ö–û–õ–¨–û–†–£ (–í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø) --- */
/* –ú–∏ –¥–æ–¥–∞—î–º–æ –∫–æ–ª—ñ—Ä –Ω–∞ –ø—Å–µ–≤–¥–æ-–µ–ª–µ–º–µ–Ω—Ç, —â–æ–± –≤—ñ–Ω –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞–≤ –∫–∞—Ä—Ç–∏–Ω–∫—É JS */
.cell::before {
    content: "";
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    border-radius: 12%;
    z-index: -1; /* –ö–æ–ª—ñ—Ä –ü–Ü–î —ñ–∫–æ–Ω–∫–æ—é */
    opacity: 0.8;
    transition: background 0.3s;
}

/* –ö–æ–ª—å–æ—Ä–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É */
.cell[data-item="0"]::before { background: radial-gradient(circle, rgba(255, 105, 180, 0.5) 0%, rgba(255, 105, 180, 0.1) 100%); }
.cell[data-item="1"]::before { background: radial-gradient(circle, rgba(255, 215, 0, 0.5) 0%, rgba(255, 215, 0, 0.1) 100%); }
.cell[data-item="2"]::before { background: radial-gradient(circle, rgba(244, 164, 96, 0.5) 0%, rgba(244, 164, 96, 0.1) 100%); }
.cell[data-item="3"]::before { background: radial-gradient(circle, rgba(147, 112, 219, 0.5) 0%, rgba(147, 112, 219, 0.1) 100%); }
.cell[data-item="4"]::before { background: radial-gradient(circle, rgba(220, 20, 60, 0.5) 0%, rgba(220, 20, 60, 0.1) 100%); }
.cell[data-item="5"]::before { background: radial-gradient(circle, rgba(144, 238, 144, 0.4) 0%, rgba(144, 238, 144, 0.1) 100%); }
.cell[data-item="6"]::before { background: radial-gradient(circle, rgba(135, 206, 250, 0.5) 0%, rgba(135, 206, 250, 0.1) 100%); }
.cell[data-item="7"]::before { background: radial-gradient(circle, rgba(255, 165, 0, 0.5) 0%, rgba(255, 165, 0, 0.1) 100%); }
.cell[data-item="8"]::before { background: radial-gradient(circle, rgba(0, 191, 255, 0.5) 0%, rgba(0, 191, 255, 0.1) 100%); }

/* –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞ –≤–∏–±–æ—Ä—É */
.selected { 
    border: 2px solid #fff !important; 
    box-shadow: 0 0 15px #fff;
    z-index: 20;
    transform: scale(1.1);
}

/* --- –ü–Ü–î–ö–ê–ó–ö–ò --- */
.hint-base {
    border: 2px solid #2ecc71 !important;
    background-color: rgba(46, 204, 113, 0.4) !important;
    box-shadow: 0 0 15px #2ecc71 !important;
    z-index: 20;
}
.hint-right { animation: nudgeRight 1s infinite; }
.hint-left { animation: nudgeLeft 1s infinite; }
.hint-down { animation: nudgeDown 1s infinite; }
.hint-up { animation: nudgeUp 1s infinite; }

.hint-right::after { content: "‚û°"; position: absolute; right: -30%; top: 20%; color: #2ecc71; font-size: 5vmin; font-weight: bold; text-shadow: 0 0 3px black; z-index: 30; }
.hint-down::after { content: "‚¨á"; position: absolute; bottom: -30%; left: 30%; color: #2ecc71; font-size: 5vmin; font-weight: bold; text-shadow: 0 0 3px black; z-index: 30; }

@keyframes nudgeRight { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(15%); } }
@keyframes nudgeLeft { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(-15%); } }
@keyframes nudgeDown { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(15%); } }
@keyframes nudgeUp { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15%); } }

/* --- –ú–ï–•–ê–ù–Ü–ö–ò --- */
.frozen::after {
    content: "‚ùÑÔ∏è"; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(135, 206, 235, 0.3); 
    border: 2px solid #fff; border-radius: 12%;
    display: flex; justify-content: center; align-items: center;
    font-size: 5vmin; text-shadow: 0 0 5px black;
    pointer-events: none; z-index: 5;
}

.chained::after {
    content: "‚õìÔ∏è"; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid #95a5a6; border-radius: 12%;
    display: flex; justify-content: center; align-items: center;
    font-size: 6vmin; pointer-events: none; z-index: 6;
}

.vines::after {
    content: "üåø"; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(46, 204, 113, 0.25); 
    border: 2px solid #27ae60; border-radius: 12%;
    display: flex; justify-content: flex-start; align-items: flex-end; 
    padding: 2px; font-size: 5vmin; text-shadow: 0 0 3px black;
    pointer-events: none; z-index: 5;
}

.stone {
    background-image: none !important; background-color: #4a4a4a !important;
    cursor: not-allowed; border: 2px solid #222;
    box-shadow: inset 0 0 10px black;
}
.stone::after {
    content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: repeating-linear-gradient(45deg, #333, #333 10px, #222 10px, #222 20px);
    opacity: 0.7; border-radius: 12%; z-index: 4;
}

.artifact {
    box-shadow: 0 0 20px gold; background-color: rgba(255, 215, 0, 0.3);
    z-index: 3; border: 2px solid gold;
}
.artifact::before {
    content: "üóùÔ∏è"; font-size: 6vmin;
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    z-index: 2; filter: drop-shadow(0 2px 2px black);
}

@keyframes shake {
    0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(0, 0); }
}
.shake-anim { animation: shake 0.3s; }

